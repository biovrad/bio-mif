tinyMCE.importPluginLanguagePack("dd");var TinyMCE_dd_Plugin={getInfo:function(){return {longname:"d:d",author:"Oliver Seidel",authorurl:"http://www.deliciousdays.com",infourl:"http://www.deliciousdays.com",version:"1.0"};},initInstance:function(_1){_1.addShortcut("ctrl","p","lang_dd_code_desc","mcedd_code");},getControlHTML:function(cn){switch(cn){case "dd_code":return tinyMCE.getButtonHTML(cn,"lang_dd_code_desc","{$pluginurl}/images/dd_code.gif","mcedd_code",true);}return "";},execCommand:function(_3,_4,_5,_6,_7){switch(_5){case "mcedd_code":var _8=false;var _9=tinyMCE.getInstanceById(_3);var _a=_9.getFocusElement();var _b=_9.selection.getSelectedHTML();if(_a.nodeName=="SPAN"&&tinyMCE.getAttrib(_a,"class")=="sfcode"){var _c=_a.parentNode;if(_a.previousSibling&&_a.previousSibling.nodeName.toUpperCase()=="#TEXT"){_a.previousSibling.nodeValue=_a.previousSibling.nodeValue+_a.textContent;}else{if(_a.nextSibling&&_a.nextSibling.nodeName.toUpperCase()=="#TEXT"){_a.nextSibling.nodeValue=_a.nextSibling.nodeValue+_a.textContent;}else{var _d=_9.getDoc().createElement("p");var _e=_9.getDoc().createTextNode(_a.textContent);_d.appendChild(_e);var _f=_c.replaceChild(_d,_a);}}_c.removeChild(_a);tinyMCE.selectedInstance.repaint();}else{if(_a.nodeName=="DIV"&&tinyMCE.getAttrib(_a,"class")=="sfcode"){var _10=_a.parentNode;var _11=_9.getDoc().createElement("p");childcount=_a.childNodes.length;for(j=0;j<childcount;j++){_11.appendChild(_a.childNodes[0]);}var _12=_10.replaceChild(_11,_a);tinyMCE.selectedInstance.repaint();}else{if(_b.length>0){if(_b.match(/<br\s?\/>/)||_b.match(/<p>/)){html="<div class=\"sfcode\">"+_b+"</div>";}else{html="<span class=\"sfcode\">"+_b+"</span>";}tinyMCE.execInstanceCommand(_3,"mceInsertContent",false,html);tinyMCE.selectedInstance.repaint();}else{return true;}}}tinyMCE.triggerNodeChange(false);return true;}return false;},handleNodeChange:function(_13,_14,_15,_16,_17,_18){if((_14.nodeName=="SPAN"||_14.nodeName=="DIV")&&tinyMCE.getAttrib(_14,"class")=="sfcode"){tinyMCE.switchClass(_13+"_dd_code","mceButtonSelected");return true;}else{if(_18==""){tinyMCE.switchClass(_13+"_dd_code","mceButtonDisabled");return true;}else{tinyMCE.switchClass(_13+"_dd_code","mceButtonNormal");}}},cleanup:function(_19,_1a,_1b){switch(_19){case "insert_to_editor_dom":break;case "insert_to_editor":break;case "get_from_editor":break;}return _1a;},_someInternalFunction:function(a,b){return 1;}};tinyMCE.addPlugin("dd",TinyMCE_dd_Plugin);